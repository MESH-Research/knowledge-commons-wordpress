"use strict";!function(t,i,e){var n,o,s=i.event;n=s.special.smartresize={setup:function(){i(this).on("resize",n.handler)},teardown:function(){i(this).off("resize",n.handler)},handler:function(t,i){var e=this,r=arguments,a=function(){t.type="smartresize",s.dispatch.apply(e,r)};o&&clearTimeout(o),i?a():o=setTimeout(a,n.threshold)},threshold:150},i.fn.smartresize=function(t){return t?this.on("smartresize",t):this.trigger("smartresize",["execAsap"])},i.Accordion=function(t,e){this.$el=i(e),this.$items=this.$el.find("ul").children("li"),this.itemsCount=this.$items.length,this._init(t)},i.Accordion.defaults={open:-1,oneOpenedItem:!1,speed:600,easing:"easeInOutExpo",scrollSpeed:900,scrollEasing:"easeInOutExpo",openLinkHeight:120},i.Accordion.prototype={_init:function(t){this.options=i.extend(!0,{},i.Accordion.defaults,t),this._validate(),this.current=this.options.open,this._originalHeight=this.$items.eq(0).find("a.lm_accordion-section-title:first").height(),this.$items.find("div.lm_accordion-section-content").hide(),this._saveDimValues(),-1!=this.current&&this._toggleItem(this.$items.eq(this.current)),this._initEvents()},_saveDimValues:function(){this.$items.each(function(){var t=i(this);t.data({originalHeight:"275px",offsetTop:t.offset().top})})},_validate:function(){(this.options.open<-1||this.options.open>this.itemsCount-1)&&(this.options.open=-1)},_initEvents:function(){var e=this;this.$items.find("a.lm_accordion-section-title:first").on("click.accordion",function(t){var n=i(this).parent();return e.options.oneOpenedItem&&e._isOpened()&&e.current!==n.index()&&e._toggleItem(e.$items.eq(e.current)),e._toggleItem(n),!1}),i(".tabs").tabslet({active:1,animation:!0}),i(".tabs").on("_after",function(){var t=i(this).closest(".lm_main");e._updateItemHeight(t)}),i(t).on("smartresize.accordion",function(t){e._saveDimValues(),e.$el.find("li.lm_open").each(function(){var t=i(this);t.css("height",t.data("originalHeight")+t.find("div.lm_accordion-section-content").outerHeight(!0))}),e._isOpened()&&e._scroll()})},_isOpened:function(){return this.$el.find("li.lm_open").length>0},_toggleItem:function(t){var i=t.find("div.lm_accordion-section-content"),e=t.find(".lm_accordion-section-title");t.hasClass("lm_open")?(this.current=-1,i.stop(!0,!0).fadeOut(this.options.speed),t.removeClass("lm_open").stop().animate({height:t.data("originalHeight")},this.options.speed,this.options.easing),e.css({height:t.data("originalHeight"),"line-height":t.data("originalHeight")})):(this.current=t.index(),i.stop(!0,!0).fadeIn(this.options.speed),t.addClass("lm_open").stop().animate({height:i.outerHeight(!0)+this.options.openLinkHeight},this.options.speed,this.options.easing),this._scroll(this),e.css({height:this.options.openLinkHeight,"line-height":this.options.openLinkHeight+"px"}))},_updateItemHeight:function(t){var i=t.find("div.lm_accordion-section-content");i.stop(!0,!0),t.stop().animate({height:i.outerHeight(!0)+this.options.openLinkHeight},this.options.speed,this.options.easing)},_scroll:function(t){var e,t=t||this;e=-1!==t.current?t.current:t.$el.find("li.lm_open:last").index(),i("html, body").stop().animate({scrollTop:t.options.oneOpenedItem?t.$items.eq(e).data("offsetTop"):t.$items.eq(e).offset().top},t.options.scrollSpeed,t.options.scrollEasing)}};var r=function(t){this.console&&console.error(t)};i.fn.accordion=function(t){if("string"==typeof t){var e=Array.prototype.slice.call(arguments,1);this.each(function(){var n=i.data(this,"accordion");return n?i.isFunction(n[t])&&"_"!==t.charAt(0)?void n[t].apply(n,e):void r("no such method '"+t+"' for accordion instance"):void r("cannot call methods on accordion prior to initialization; attempted to call method '"+t+"'")})}else this.each(function(){var e=i.data(this,"accordion");e||i.data(this,"accordion",new i.Accordion(t,this))});return this}}(window,jQuery);var LM=function(t){function i(t,i,e){function n(t){return(o?/^\d+[A-Za-z]*$/:/^\d+$/).test(t)}var o=e&&e.lexicographical,s=e&&e.zeroExtend,r=t.split("."),a=i.split(".");if(!r.every(n)||!a.every(n))return NaN;if(s){for(;r.length<a.length;)r.push("0");for(;a.length<r.length;)a.push("0")}o||(r=r.map(Number),a=a.map(Number));for(var c=0;c<r.length;++c){if(a.length==c)return 1;if(r[c]!=a[c])return r[c]>a[c]?1:-1}return r.length!=a.length?-1:0}function e(t){if(!+t)return!1;for(var i=String(+t).split(""),e=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],n="",o=3;o--;)n=(e[+i.pop()+10*o]||"")+n;return Array(+i.join("")+1).join("M")+n}function n(t,i,e){var n;return function(){var o=this,s=arguments,r=function(){n=null,e||t.apply(o,s)},a=e&&!n;clearTimeout(n),n=setTimeout(r,i),a&&t.apply(o,s)}}var o={fontRatio:60,goUpButtonThreshold:750},s=function(){t("#lm").flowtype({minimum:500,maximum:1200,minFont:13,maxFont:42,fontRatio:o.fontRatio})},r=["http://www.gutenberg.org/files/17489/17489-h/17489-h.htm","http://www.gutenberg.org/files/17493/17493-h/17493-h.htm","http://www.gutenberg.org/files/17494/17494-h/17494-h.htm","http://www.gutenberg.org/files/17518/17518-h/17518-h.htm","http://www.gutenberg.org/files/17519/17519-h/17519-h.htm"],a=[["","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],["","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],["","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],["","b","c","d","e","f","g","h","p","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],["","b","c","d","e","f","g","h","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]];t.extend(t.fn.dataTableExt.oSort,{"chapter-number-asc":function(t,e){return i(t,e)},"chapter-number-desc":function(t,e){return i(e,t)}});var c=t("#lm_accordion"),h=t("#go-up-link"),l=t("a.lm_accordion-section-title"),p=0,u=n(function(){var i=c.find("li.lm_open").length>0||0;if(i){var e=i?p:0,n="#section-"+e,s=t(document).scrollTop(),r=t(n).offset();s-r.top>o.goUpButtonThreshold?(h.fadeIn(800),h.prop("href",n)):h.fadeOut(200)}},100);return{init:function(i){"undefined"==typeof i&&(i=!1),i===!0&&s();var n=t("#lm_accordion");n.accordion({oneOpenedItem:!0}),l.on("click.accordion",function(){p=t(this).closest(".lm_main").data("section-id")}),t("#lm_table-chapters").DataTable({paging:!1,searching:!1,info:!1,autoWidth:!1,columnDefs:[{targets:[0],type:"chapter-number"},{width:"1%",targets:[0,1,2]}]}),t("#lm_table-characters").DataTable({paging:!1,searching:!1,info:!1,columnDefs:[]}),t(".lm_table, .jump-to").on("click","a",function(){return t(window).scrollTo(t(this).attr("href"),2e3,{interrupt:!0,offset:-160,onAfter:function(t){t.toggleClass("flash-row"),setTimeout(function(){t.toggleClass("flash-row")},1200)}}),!1}),t(".toc").on("click","a",function(){return t(window).scrollTo(t(this).attr("href"),1e3,{interrupt:!0,offset:-15}),!1}),h.on("click",function(){return t(window).scrollTo(t(this).attr("href"),1e3,{interrupt:!0,offset:-30}),!1}),t(".chapter-lookup").on("click",function(){var i=t(this),n=i.closest("tr").data("chapterid"),o=n.split(".").map(function(t){return parseInt(t)}),s=o[0]||1,c=o[1]||1,h=o[2]||1,l=r[s-1]+"#Chapitre_"+e(h)+a[s-1][c-1];return window.open(l,"_blank"),!1}),t(".tabs").on("_after",function(i){var e=t(i.target),n=t(e.closest(".tabs"));t(window).scrollTo(n,600,{interrupt:!0,offset:-45})}),window.addEventListener("scroll",u)}}}(jQuery);